---
title: "Homework 5 Answers"
author: "Xuan Beatty"
date: "2025-12-01"
output: pdf_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(
  echo = TRUE,
  results = 'markup',
  warning = FALSE,
  message = FALSE,
  error = FALSE)

```

## Libraries needed

```{r}

library(dplyr)
library(tidyr)
library(broom)
library(purrr)
library(ggplot2)
library(stringr)
library(lubridate)
library(here)

```

## Reading in the data

```{r reading in the data}

homicides <- read.csv(here("data", "homicide-data.csv"))

# Creating a new column combining city and state
homicides <- homicides %>%
  mutate(city_name = paste(city, state, sep = ", "))

homicides <- homicides %>%
  mutate(reported_date = ymd(reported_date))

```

## Selecting only Baltimore Data

```{r selecting baltimoredata}

baltimore_monthly <- homicides %>%
  filter(city_name == "Baltimore, MD") %>%
  mutate(month = floor_date(reported_date, "month")) %>%
  count(month, name = "homicides")

baltimore_monthly <- baltimore_monthly %>%
  mutate(
    season = ifelse(month(month) %in% c(11,12,1,2,3,4),
                    "Winter", "Summer")
  )

freddie_date <- as.Date("2015-04-12")

```

## Baltimore Graph

Recreate a graph that shows monthly homicides in Baltimore, with a reference added for the date of the arrest of Freddie Gray and color used to show colder months (November through April) versus warmer months (May through October). There is a smooth line added to help show seasonal and long-term trends in this data.


```{r fig.width=12, fig.height=4}

ggplot(baltimore_monthly, aes(x = month, y = homicides, fill = season)) +
  geom_col(color = "gray30") +
  scale_fill_manual(values = c("Summer" = "lightgray", "Winter" = "skyblue")) +
  
  geom_smooth(aes(group = 1), se = FALSE, color = "blue", size = 1, span = 0.2) +
  
  geom_vline(
    xintercept = freddie_date,
    color = "red", linetype = "dashed", size = 1) +

  annotate("text",
           x = freddie_date + 150,
           y = max(baltimore_monthly$homicides) * 0.95,
           label = "Arrest of\nFreddie Gray",
           color = "white", 
           hjust = 1.75, size = 5.2) +

  labs(
    title = "Homicides in Baltimore, MD",
    x = "Date",
    y = "Monthly homicides",
    fill = "") +

  theme_minimal(base_size = 15) +
  theme(
    panel.background = element_rect(fill = "gray50", color = NA),
    plot.background = element_rect(fill = NA, color = NA),
    panel.grid.major = element_line(color = "gray40"),
    panel.grid.minor = element_blank(),
    
    axis.text = element_text(color = "black", size = 13),
    axis.title = element_text(color = "black", size = 15),
    plot.title = element_text(color = "black", face = "bold", size = 17),
    legend.position = "bottom",
    legend.text = element_text(color = "black", size = 13))



```

